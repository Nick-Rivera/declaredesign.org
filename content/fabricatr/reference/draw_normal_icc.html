---
title: "fabricatr"
---

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Draw normal data with fixed intra-cluster correlation.</h1>
    </div>

    
    <p>Data is generated to ensure inter-cluster correlation 0, intra-cluster
correlation in expectation ICC. The data generating process
used in this function is specified at the following URL:
<a href='https://stats.stackexchange.com/questions/263451/create-synthetic-data-with-a-given-intraclass-correlation-coefficient-icc'>https://stats.stackexchange.com/questions/263451/create-synthetic-data-with-a-given-intraclass-correlation-coefficient-icc</a></p>
    

    <pre class="usage"><span class='fu'>draw_normal_icc</span>(<span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>N</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>clusters</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sd_between</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ICC</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mean</th>
      <td><p>A number or vector of numbers, one mean per cluster. If none is
provided, will default to 0.</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>(Optional) A number indicating the number of observations to be
generated. Must be equal to length(clusters) if provided.</p></td>
    </tr>
    <tr>
      <th>clusters</th>
      <td><p>A vector of factors or items that can be coerced to
clusters; the length will determine the length of the generated data.</p></td>
    </tr>
    <tr>
      <th>sd</th>
      <td><p>A number or vector of numbers, indicating the standard deviation of
each cluster's error terms -- standard deviation within a cluster (default 1)</p></td>
    </tr>
    <tr>
      <th>sd_between</th>
      <td><p>A number or vector of numbers, indicating the standard deviation
between clusters.</p></td>
    </tr>
    <tr>
      <th>ICC</th>
      <td><p>A number indicating the desired ICC.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of numbers corresponding to the observations from
the supplied cluster IDs.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The typical use for this function is for a user to provide an <code>ICC</code> and,
optionally, a set of within-cluster standard deviations, <code>sd</code>. If the
user does not provide <code>sd</code>, the default value is 1. These arguments
imply a fixed between-cluster standard deviation.</p>
<p>An alternate mode for the function is to provide between-cluster standard
deviations, <code>sd_between</code>, and an <code>ICC</code>. These arguments imply
a fixed within-cluster standard deviation.</p>
<p>If users provide all three of <code>ICC</code>, <code>sd_between</code>, and
<code>sd</code>, the function will warn the user and use the provided standard
deviations for generating the data.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Divide observations into clusters</span>
<span class='no'>clusters</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='fl'>10</span>)

<span class='co'># Default: unit variance within each cluster</span>
<span class='fu'>draw_normal_icc</span>(<span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>clusters</span>, <span class='kw'>ICC</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)</div><div class='output co'>#&gt;  [1]  1.000286259 -0.350477376  0.114883667 -0.003404692 -1.511881385
#&gt;  [6]  0.096288172  0.013452018  0.548951081  1.525881109 -0.058099822
#&gt; [11] -0.466481368  0.409492885  2.198182900  0.554083743 -1.482046882
#&gt; [16]  1.087213106  1.158210858  0.086438759  1.019489703 -0.600580733
#&gt; [21]  0.758749101  2.086314725  0.536604062 -0.999835836 -1.890010336
#&gt; [26]  0.417855639  1.574734847  0.057900831  1.013157444 -2.022305794
#&gt; [31]  2.183595232  0.611229810 -0.072939135  0.707083429  0.339465358
#&gt; [36]  1.294396863  1.027671393 -1.942768205 -0.893624270 -3.637986442
#&gt; [41]  0.474812453  1.339209315  0.248640382  1.140094769 -2.784799681
#&gt; [46]  0.937146053  2.202973926 -0.153854719  1.162087829 -0.422974080</div><div class='input'>
<span class='co'># Alternatively, you can specify characteristics:</span>
<span class='fu'>draw_normal_icc</span>(<span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>clusters</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>ICC</span> <span class='kw'>=</span> <span class='fl'>0.3</span>)</div><div class='output co'>#&gt;  [1] 13.336565 14.900882  7.419541  9.358814  1.502337 10.720012 10.846742
#&gt;  [8]  6.938163 13.842068  5.529905 15.153156 11.937726  2.234610 11.403043
#&gt; [15]  8.574015  6.625256 10.648724 12.729604 10.552674 13.093974 10.563272
#&gt; [22]  9.243599  9.218643 11.568465  8.062429 16.231183 14.300342  5.905605
#&gt; [29] 13.861193  7.959788 14.916012 11.371808 11.777774 13.627605  7.361886
#&gt; [36] 13.115337 17.287335 -2.031954  8.978745  8.509982 13.444668 13.115661
#&gt; [43]  2.732933  8.769808 10.227345  6.296540 13.688855 10.423066 11.711181
#&gt; [50] 12.531001</div><div class='input'>
<span class='co'># Can specify between-cluster standard deviation instead:</span>
<span class='fu'>draw_normal_icc</span>(<span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>clusters</span>, <span class='kw'>sd_between</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>ICC</span> <span class='kw'>=</span> <span class='fl'>0.2</span>)</div><div class='output co'>#&gt;  [1]  15.8871287  -2.9692897 -14.0545881   0.2882491  -3.0860306  -8.4872759
#&gt;  [7]   2.9192751 -12.8156132  -1.2653287   3.3948065   5.4130561   5.5595919
#&gt; [13] -10.6708775   9.2887191  11.8527768   4.2002336   1.7659491   3.1321377
#&gt; [19]  12.9072470  -4.0573466   5.2112388  -9.7239469   1.0766048   2.3854572
#&gt; [25] -10.9097612  12.0539783  -2.0003135 -10.6525890  -7.5209270  -8.0849025
#&gt; [31]   4.5059396   3.0652696  -6.6219084   6.9405990  -6.0656795 -12.2659665
#&gt; [37]   0.9854158 -18.5194597 -13.7936461  -3.2541664   5.3101215  12.5544380
#&gt; [43]  -9.1480108  -0.5848016   9.2998706   5.5607672  13.6962360 -14.9632547
#&gt; [49]  -9.7065406  -2.2160346</div><div class='input'>
<span class='co'># Verify that ICC generated is accurate</span>
<span class='no'>corr_draw</span> <span class='kw'>=</span> <span class='fu'>draw_normal_icc</span>(<span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>clusters</span>, <span class='kw'>ICC</span> <span class='kw'>=</span> <span class='fl'>0.4</span>)
<span class='fu'>summary</span>(<span class='fu'>lm</span>(<span class='no'>corr_draw</span> ~ <span class='fu'>as.factor</span>(<span class='no'>clusters</span>)))$<span class='no'>r.squared</span></div><div class='output co'>#&gt; [1] 0.4354426</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>
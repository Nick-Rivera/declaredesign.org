---
title: "Declare Design — declare_design • DeclareDesign"
---


<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Declare Design</h1>
    </div>

    
    <p>Declare Design</p>
    

    <pre class="usage"><span class='fu'>declare_design</span>(<span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>A set of steps in a research design, beginning with a <code>data.frame</code> representing the population or a function that draws the population. Steps are evaluated sequentially. With the exception of the first step, all steps must be functions that take a <code>data.frame</code> as an argument and return a <code>data.frame</code>. Typically, many steps are declared using the <code>declare_</code> functions, i.e., <code><a href='declare_population.html'>declare_population</a></code>, <code><a href='declare_population.html'>declare_population</a></code>, <code><a href='declare_sampling.html'>declare_sampling</a></code>, <code><a href='declare_potential_outcomes.html'>declare_potential_outcomes</a></code>, <code><a href='declare_estimand.html'>declare_estimand</a></code>, <code><a href='declare_assignment.html'>declare_assignment</a></code>, and <code><a href='declare_estimator.html'>declare_estimator</a></code>. Functions from the <code>dplyr</code> package such as mutate can also be usefully included.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of two functions, the <code>design_function</code> and the <code>data_function</code>. The <code>design_function</code> runs the design once, i.e. draws the data and calculates any estimates and estimands defined in <code>...</code>, returned separately as two <code>data.frame</code>'s. The <code>data_function</code> runs the design once also, but only returns the final data.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Users can supply three kinds of functions to declare_design:</p>
<p>1. Data generating functions. These include population, assignment, and sampling functions.</p>
<p>2. Estimand functions.</p>
<p>3. Estimator functions.</p>
<p>The location of the estimand and estimator functions in the chain of functions determine *when* the values of the estimand and estimator are calculated. This allows users to, for example, differentiate between a population average treatment effect and a sample average treatment effect by placing the estimand function before or after sampling.</p>
<p>Designs declared with declare_design can be investigated with a series of post-declaration commands, such as <code><a href='post_design.html'>draw_data</a></code>, <code><a href='post_design.html'>get_estimands</a></code>, <code><a href='post_design.html'>get_estimates</a></code>, and <code><a href='diagnose_design.html'>diagnose_design</a></code>.</p>
<p>The print and summary methods for a design object return some helpful descriptions of the steps in your research design. If randomizr functions are used for any assignment or sampling steps, additional details about those steps are provided.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>my_population</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='declare_population.html'>declare_population</a></span>(<span class='kw'>N</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>noise</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='no'>N</span>))

<span class='no'>my_potential_outcomes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='declare_potential_outcomes.html'>declare_potential_outcomes</a></span>(
  <span class='kw'>Y_Z_0</span> <span class='kw'>=</span> <span class='no'>noise</span>, <span class='kw'>Y_Z_1</span> <span class='kw'>=</span> <span class='no'>noise</span> +
  <span class='fu'>rnorm</span>(<span class='no'>N</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>2</span>))

<span class='no'>my_sampling</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='declare_sampling.html'>declare_sampling</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>250</span>)

<span class='no'>my_assignment</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='declare_assignment.html'>declare_assignment</a></span>(<span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>25</span>)

<span class='no'>my_estimand</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='declare_estimand.html'>declare_estimand</a></span>(<span class='kw'>ATE</span> <span class='kw'>=</span> <span class='fu'>mean</span>(<span class='no'>Y_Z_1</span> - <span class='no'>Y_Z_0</span>))

<span class='no'>my_estimator</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='declare_estimator.html'>declare_estimator</a></span>(<span class='no'>Y</span> ~ <span class='no'>Z</span>, <span class='kw'>estimand</span> <span class='kw'>=</span> <span class='no'>my_estimand</span>)

<span class='no'>design</span> <span class='kw'>&lt;-</span> <span class='fu'>declare_design</span>(<span class='no'>my_population</span>,
                         <span class='no'>my_potential_outcomes</span>,
                         <span class='no'>my_sampling</span>,
                         <span class='no'>my_estimand</span>,
                         <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>noise_sq</span> <span class='kw'>=</span> <span class='no'>noise</span>^<span class='fl'>2</span>),
                         <span class='no'>my_assignment</span>,
                         <span class='no'>reveal_outcomes</span>,
                         <span class='no'>my_estimator</span>)

<span class='no'>design</span></div><div class='output co'>#&gt; 
#&gt; Design Summary
#&gt; 
#&gt; Step 1 (): declare_population(N = 500, noise = rnorm(N)) 
#&gt; 
#&gt; N = 500 
#&gt; 
#&gt; Added variable: ID 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt; Added variable: noise 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -2.94  -0.07 -0.03 2.65 0.99         0      500
#&gt; 
#&gt; Step 2 (): declare_potential_outcomes(Y_Z_0 = noise, Y_Z_1 = noise + rnorm(N,     mean = 2, sd = 2)) 
#&gt; 
#&gt; Added variable: fab_ID_1 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt; Added variable: Y_Z_0 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -2.94  -0.07 -0.03 2.65 0.99         0      500
#&gt; 
#&gt; Added variable: Y_Z_1 
#&gt;    min median mean max   sd N_missing N_unique
#&gt;  -4.44   1.78 1.81 8.1 2.29         0      500
#&gt; 
#&gt; Step 3 (): declare_sampling(n = 250) 
#&gt; 
#&gt; N = 250 (250 subtracted) 
#&gt; 
#&gt; Added variable: S_inclusion_prob 
#&gt;   0.5
#&gt;   250
#&gt;  1.00
#&gt; 
#&gt; Altered variable: ID 
#&gt;   Before: 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt;   After:
#&gt;  N_missing N_unique     class
#&gt;          0      250 character
#&gt; 
#&gt; Altered variable: noise 
#&gt;   Before: 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -2.94  -0.07 -0.03 2.65 0.99         0      500
#&gt; 
#&gt;   After:
#&gt;    min median  mean  max sd N_missing N_unique
#&gt;  -2.81  -0.05 -0.04 2.65  1         0      250
#&gt; 
#&gt; Altered variable: fab_ID_1 
#&gt;   Before: 
#&gt;  N_missing N_unique     class
#&gt;          0      500 character
#&gt; 
#&gt;   After:
#&gt;  N_missing N_unique     class
#&gt;          0      250 character
#&gt; 
#&gt; Altered variable: Y_Z_0 
#&gt;   Before: 
#&gt;    min median  mean  max   sd N_missing N_unique
#&gt;  -2.94  -0.07 -0.03 2.65 0.99         0      500
#&gt; 
#&gt;   After:
#&gt;    min median  mean  max sd N_missing N_unique
#&gt;  -2.81  -0.05 -0.04 2.65  1         0      250
#&gt; 
#&gt; Altered variable: Y_Z_1 
#&gt;   Before: 
#&gt;    min median mean max   sd N_missing N_unique
#&gt;  -4.44   1.78 1.81 8.1 2.29         0      500
#&gt; 
#&gt;   After:
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -4.11   1.71 1.63 7.11 2.29         0      250
#&gt; 
#&gt; Step 4 (): declare_estimand(ATE = mean(Y_Z_1 - Y_Z_0)) 
#&gt; 
#&gt; A single draw of the :
#&gt;  estimand_label estimand
#&gt;             ATE 1.669875
#&gt; 
#&gt; Step 5 (): dplyr::mutate(noise_sq = noise^2) 
#&gt; 
#&gt; Added variable: noise_sq 
#&gt;  min median mean  max   sd N_missing N_unique
#&gt;    0   0.47 0.99 7.88 1.38         0      250
#&gt; 
#&gt; Step 6 (): declare_assignment(m = 25) 
#&gt; 
#&gt; Added variable: Z 
#&gt;     0    1
#&gt;   225   25
#&gt;  0.90 0.10
#&gt; 
#&gt; Added variable: Z_cond_prob 
#&gt;   0.1  0.9
#&gt;    25  225
#&gt;  0.10 0.90
#&gt; 
#&gt; Step 7 (): NULL 
#&gt; 
#&gt; Added variable: Y 
#&gt;    min median mean  max   sd N_missing N_unique
#&gt;  -3.77   0.01 0.06 5.64 1.23         0      250
#&gt; 
#&gt; Step 8 (): declare_estimator(Y ~ Z, estimand = my_estimand) 
#&gt; 
#&gt; Formula: Y ~ Z 
#&gt; 
#&gt; A single draw of the :
#&gt;  estimator_label coefficient_name       est        se          p    ci_lower
#&gt;     my_estimator                Z 0.9070776 0.4666258 0.06322904 -0.05389551
#&gt;  ci_upper estimand_label
#&gt;  1.868051            ATE
#&gt; </div><div class='input'>
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='post_design.html'>draw_data</a></span>(<span class='no'>design</span>)

<span class='no'>estimates</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='post_design.html'>get_estimates</a></span>(<span class='no'>design</span>)
<span class='no'>estimands</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='post_design.html'>get_estimands</a></span>(<span class='no'>design</span>)</div><span class='co'># NOT RUN {</span>
<span class='no'>diagnosis</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='diagnose_design.html'>diagnose_design</a></span>(<span class='no'>design</span>)

<span class='fu'>summary</span>(<span class='no'>diagnosis</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>